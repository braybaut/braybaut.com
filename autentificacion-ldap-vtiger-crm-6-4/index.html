<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author"
    content="braybaut">
<meta name="description"
    content="
Vtiger es un CRM de código abierto muy potente que trata de acercarse a grandes crms como salesforce y SugarCRM, pero en esta ocasión veremos como autentificarlo hacia LDAP.
Con un gran compañero de la compañía Gabo, logramos hacer la autentificación continuación describo los pasos para lograrla.
Para lograr la autentificación debemos usar los archivos de autentificación de Vtiger de 5.x, estos archivos los encuentran en github.
https://github.com/braybaut/ldap-vtiger
" />
<meta name="keywords" content="" />
<meta name="robots" content="noodp" />
<link rel="canonical" href="https://braybaut.com/autentificacion-ldap-vtiger-crm-6-4/" />


<title>
    
    Autentificación LDAP Vtiger CRM 6 :: Hello Friend NG 
    
</title>



<link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,700|Source+Code+Pro" rel="stylesheet"
    type="text/css">
<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.1/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">


<link rel="stylesheet" href="https://braybaut.com/scss/main.min.2cb2cfcb2d25c14d702e06c24f9c05a189f6cbc9ef31f0a235fd739b411a5a1b.css">



<link rel="apple-touch-icon" sizes="180x180" href="https://braybaut.com/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://braybaut.com/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://braybaut.com/favicon-16x16.png">
<link rel="manifest" href="https://braybaut.com/site.webmanifest">
<link rel="mask-icon" href="https://braybaut.com/safari-pinned-tab.svg" color="#252627">
<link rel="shortcut icon" href="https://braybaut.com/favicon.ico">
<meta name="theme-color" content="#252627">
<meta itemprop="name" content="Autentificación LDAP Vtiger CRM 6">
<meta itemprop="description" content="

Vtiger es un CRM de código abierto muy potente que trata de acercarse  a grandes crms como salesforce y SugarCRM, pero en esta ocasión veremos como autentificarlo hacia LDAP.

Con un gran compañero de la compañía Gabo, logramos hacer la autentificación continuación describo los pasos para lograrla.

Para lograr la autentificación debemos usar los archivos de autentificación de Vtiger de 5.x,  estos archivos los encuentran en github.

https://github.com/braybaut/ldap-vtiger">


<meta itemprop="datePublished" content="2016-01-19T01:43:11&#43;00:00" />
<meta itemprop="dateModified" content="2016-01-19T01:43:11&#43;00:00" />
<meta itemprop="wordCount" content="403">



<meta itemprop="keywords" content="autentificación,crm,ldap,tutoriales,vtiger,vtiger 6.0,vtiger 6.4,vtiger crm," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Autentificación LDAP Vtiger CRM 6"/>
<meta name="twitter:description" content="

Vtiger es un CRM de código abierto muy potente que trata de acercarse  a grandes crms como salesforce y SugarCRM, pero en esta ocasión veremos como autentificarlo hacia LDAP.

Con un gran compañero de la compañía Gabo, logramos hacer la autentificación continuación describo los pasos para lograrla.

Para lograr la autentificación debemos usar los archivos de autentificación de Vtiger de 5.x,  estos archivos los encuentran en github.

https://github.com/braybaut/ldap-vtiger"/>



<meta property="article:section" content="LDAP" />
<meta property="article:section" content="TUTORIALES" />

<meta property="article:published_time" content="2016-01-19 01:43:11 &#43;0000 &#43;0000" />








    </head>

    <body class="dark-theme">
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="https://braybaut.com/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text">$ cd /home/braybaut</span>
            <span class="logo__cursor"></span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="https://braybaut.com/about">About</a></li><li><a href="https://braybaut.com/posts">Blog</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            

            <span class="theme-toggle"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>
</span>
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            
            </p>
        </div>

        <article>
            <h2 class="post-title"><a href="https://braybaut.com/autentificacion-ldap-vtiger-crm-6-4/">Autentificación LDAP Vtiger CRM 6</a></h2>

            

            <div class="post-content">
                <p><a href="https://i1.wp.com/braybaut.com/wp-content/uploads/2016/01/Vtiger-Logo-1.jpg?ssl=1" rel="attachment wp-att-641"><img class="aligncenter size-full wp-image-641" src="https://i1.wp.com/braybaut.com/wp-content/uploads/2016/01/Vtiger-Logo-1.jpg?resize=648%2C195&#038;ssl=1" alt="Vtiger-Logo-1" width="648" height="195" srcset="https://i1.wp.com/braybaut.com/wp-content/uploads/2016/01/Vtiger-Logo-1.jpg?w=3546&ssl=1 3546w, https://i1.wp.com/braybaut.com/wp-content/uploads/2016/01/Vtiger-Logo-1.jpg?resize=300%2C90&ssl=1 300w, https://i1.wp.com/braybaut.com/wp-content/uploads/2016/01/Vtiger-Logo-1.jpg?resize=768%2C231&ssl=1 768w, https://i1.wp.com/braybaut.com/wp-content/uploads/2016/01/Vtiger-Logo-1.jpg?resize=1024%2C308&ssl=1 1024w, https://i1.wp.com/braybaut.com/wp-content/uploads/2016/01/Vtiger-Logo-1.jpg?resize=750%2C226&ssl=1 750w, https://i1.wp.com/braybaut.com/wp-content/uploads/2016/01/Vtiger-Logo-1.jpg?w=1296&ssl=1 1296w, https://i1.wp.com/braybaut.com/wp-content/uploads/2016/01/Vtiger-Logo-1.jpg?w=1944&ssl=1 1944w" sizes="(max-width: 648px) 100vw, 648px" data-recalc-dims="1" /></a></p>

<p>Vtiger es un CRM de código abierto muy potente que trata de acercarse  a grandes crms como salesforce y SugarCRM, pero en esta ocasión veremos como autentificarlo hacia LDAP.</p>

<p>Con un gran compañero de la compañía <a href="https://twitter.com/Gabo_fdc?s=09" target="_blank">Gabo</a>, logramos hacer la autentificación continuación describo los pasos para lograrla.</p>

<p>Para lograr la autentificación debemos usar los archivos de autentificación de Vtiger de 5.x,  estos archivos los encuentran en github.</p>

<p><a href="https://github.com/braybaut/ldap-vtiger" target="_blank"><a href="https://github.com/braybaut/ldap-vtiger" target="_blank">https://github.com/braybaut/ldap-vtiger</a></a></p>

<p>Los archivos Ldap.php y config.ldap.php deben quedar en la siguiente ruta:</p>

<pre class="lang:default decode:true">/var/www/html/vtigercrm/include/ldap/</pre>

<p><strong>Nota: debe editar el archivo Config.ldap.php y adicionar la configuración de su servidor LDAP</strong></p>

<p><em>la ruta puede variar dependiendo de donde tenga ubicado los archivos de  vtiger.</em></p>

<p>A continuación debemos hacer unos cambios en el archivo:</p>

<pre class="lang:default decode:true">/var/www/html/vtigercrm/modules/Users/Users.php</pre>

<p>Este archivo es el encargado de hacer la autentificación de los usuarios, aquí lo que vamos  hacer es llamar  los archivos <strong>Ldap.php y Config.ldap.php</strong> para que lea las variables y posteriormente lograr la autentificación, igualmente haremos un cambio en una función para que no se presenten problemas.</p>

<p>Adicionar las siguientes dos lineas al final de los require once , aproximadamente en la linea 41:</p>

<pre class="lang:default decode:true">require_once 'include/ldap/config.ldap.php';
require_once 'include/ldap/ldap.php';</pre>

<p>La función dologin la cual es:</p>

<pre class="lang:default decode:true">function doLogin($user_password) {
        global $AUTHCFG;
        $usr_name = $this-&gt;column_fields["user_name"];

        switch (strtoupper($AUTHCFG['authType'])) {
            case 'LDAP':
                $this-&gt;log-&gt;debug("Using LDAP authentication");
                require_once('modules/Users/authTypes/LDAP.php');
                $result = ldapAuthenticate($this-&gt;column_fields["user_name"], $user_password);
                if ($result == NULL) {
                    return false;
                } else {
                    return true;
                }
                break;
</pre>

<p>Debe ser cambiada por esta:</p>

<pre class="lang:default decode:true">function doLogin($user_password) {
        global $AUTHCFG;
        $usr_name = $this-&gt;column_fields["user_name"];

        // Allow the 'admin' always to log in independent from the LDAP server
        $usr_list = $AUTHCFG['sql_accounts'];

        if (in_array(strtolower($usr_name), $usr_list))
            $AUTHCFG['authType'] = 'SQL';

        //SEAN TSANG PATCH START - User must exists in database first
        $query = "SELECT * from $this-&gt;table_name where user_name=?";
               $result = $this-&gt;db-&gt;requirePsSingleResult($query, array($usr_name), false);
              if (empty($result)) return false;
        //SEAN TSANG PATCH END------------------------------------------

        switch (strtoupper($AUTHCFG['authType'])) {
            case 'LDAP':
                $this-&gt;log-&gt;debug("Using LDAP authentication");
                require_once('include/ldap/Ldap.php');
                return ldapAuthenticate($this-&gt;column_fields["user_name"], $user_password);
</pre>

<p>Después de estos cambios la autentificación desde LDAP debe funcionar.</p>

<p>Importante:</p>

<p>Automáticamente el no autentificara con los usuarios que esten el el servidor LDAP, Para que funcione debe crear los usuarios en vtiger con  usuario, contraseña, correo electrónico, etc  <strong>(NO IMPORTA LA CONTRASEÑA QUE ASIGNE AL CREAR LA CUENTA,  AL AUTENTIFICARSE CON UN USUARIO, VTIGER BUSCARA LA CONTRASEÑA EN EL SERVIDOR LDAP Y NO USARA LA QUE USTED ASIGNO, EL USERNAME DEL USUARIO DE VTIGER DEBE SER EL MISMO USERNAME DEL USUARIO EN LDAP)</strong></p>

<p>PD: Funciona para todas las versiones de 6.X tanto para 6.0 como para 6.4</p>
            </div>
        </article>

        <hr />

        <div class="post-info">
  				<p>
  					<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg><span class="tag"><a href="https://braybaut.com/tags/autentificaci%C3%B3n">autentificación</a></span><span class="tag"><a href="https://braybaut.com/tags/crm">crm</a></span><span class="tag"><a href="https://braybaut.com/tags/ldap">ldap</a></span><span class="tag"><a href="https://braybaut.com/tags/tutoriales">tutoriales</a></span><span class="tag"><a href="https://braybaut.com/tags/vtiger">vtiger</a></span><span class="tag"><a href="https://braybaut.com/tags/vtiger-6.0">vtiger 6.0</a></span><span class="tag"><a href="https://braybaut.com/tags/vtiger-6.4">vtiger 6.4</a></span><span class="tag"><a href="https://braybaut.com/tags/vtiger-crm">vtiger crm</a></span>
  				</p>
  			</div>

        
    </main>

            </div>

            
                <footer class="footer">
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2019</span>
            
                <span><a href="https://braybaut.com">Braybaut</a></span>
            
            <span></span>
            <span> <a href="https://braybaut.com/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
        </div>
    </div>
    <div class="footer__inner">
        <div class="footer__content">

        </div>
    </div>
    <div class="footer__inner">
        <div class="footer__content">
            <span>Powered by <a href="http://gohugo.io">Hugo</a></span>
            <span>Made with &#10084; by <a href="https://github.com/rhazdon">rhazdon</a></span>
        </div>
    </div>
</footer>

            
        </div>

        





<script type="text/javascript" src="https://braybaut.com/js/bundle.4b80fbbfab88198dcef181b034822e60a3e68b1c128d1dc05392a32943a18ec2f866fbcd9ce31dcf84134397161647ad605ea5c25ecf12e5fcf9d28b47e64bb5.js" integrity="sha512-S4D7v6uIGY3O8YGwNIIuYKPmixwSjR3AU5KjKUOhjsL4ZvvNnOMdz4QTQ5cWFketYF6lwl7PEuX8&#43;dKLR&#43;ZLtQ=="></script>



    </body>
</html>
